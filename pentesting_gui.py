import tkinter as tk
from tkinter import ttk
from tkinter import messagebox
import subprocess

# Fonction pour démarrer les scans
def start_scan(tool):
    try:
        # Lancer le scan correspondant en fonction de l'outil choisi
        if tool == "Nmap":
            messagebox.showinfo("Nmap Scan", "Starting Nmap Scan...")
            subprocess.run(["nmap", "-sP", "192.168.1.0/24"], check=True)  # Exemple de scan réseau Nmap
        elif tool == "SQLMap":
            messagebox.showinfo("SQLMap Scan", "Starting SQLMap Scan...")
            subprocess.run(["sqlmap", "-u", "http://testphp.vulnweb.com"], check=True)  # Exemple de scan SQLMap
        elif tool == "WPScan":
            messagebox.showinfo("WPScan Scan", "Starting WPScan...")
            subprocess.run(["wpscan", "--url", "http://testphp.vulnweb.com"], check=True)  # Exemple de scan WPScan
        elif tool == "Gobuster":
            messagebox.showinfo("Gobuster Scan", "Starting Gobuster Scan...")
            subprocess.run(["gobuster", "dir", "-u", "http://testphp.vulnweb.com", "-w", "/usr/share/wordlists/dirb/common.txt"], check=True)  # Exemple de scan Gobuster
        elif tool == "Nikto":
            messagebox.showinfo("Nikto Scan", "Starting Nikto Scan...")
            subprocess.run(["nikto", "-h", "http://testphp.vulnweb.com"], check=True)  # Exemple de scan Nikto
        messagebox.showinfo("Scan Completed", f"{tool} Scan has completed successfully!")
    except subprocess.CalledProcessError:
        messagebox.showerror("Error", f"An error occurred while running {tool}.")

# Création de la fenêtre principale
root = tk.Tk()
root.title("Penetration Testing Tools")
root.geometry("600x400")
root.configure(bg="lightblue")

# Style personnalisé
style = ttk.Style()
style.configure('TButton', font=('Helvetica', 12), padding=10)
style.theme_use("clam")

# Ajout d'un label
label = ttk.Label(root, text="Select a tool to run the scan", font=("Helvetica", 14))
label.pack(pady=20)

# Frame pour les boutons
frame = ttk.Frame(root)
frame.pack(padx=20, pady=20)

# Boutons pour lancer les scans
button1 = ttk.Button(frame, text="Start Nmap Scan", style='TButton', command=lambda: start_scan("Nmap"))
button1.grid(row=0, column=0, padx=10, pady=10)

button2 = ttk.Button(frame, text="Start SQLMap Scan", style='TButton', command=lambda: start_scan("SQLMap"))
button2.grid(row=0, column=1, padx=10, pady=10)

button3 = ttk.Button(frame, text="Start WPScan", style='TButton', command=lambda: start_scan("WPScan"))
button3.grid(row=1, column=0, padx=10, pady=10)

button4 = ttk.Button(frame, text="Start Gobuster Scan", style='TButton', command=lambda: start_scan("Gobuster"))
button4.grid(row=1, column=1, padx=10, pady=10)

button5 = ttk.Button(frame, text="Start Nikto Scan", style='TButton', command=lambda: start_scan("Nikto"))
button5.grid(row=2, column=0, padx=10, pady=10)

# Ajouter une étiquette d'information supplémentaire
info_label = ttk.Label(root, text="Make sure all tools are installed before running.", font=("Helvetica", 10))
info_label.pack(pady=20)

# Lancer l'interface
root.mainloop()
